# 搜索

要使用此文档所示的接口，请先[登录](./登录.md)。

## 预览结果

```text
GET /_/search/summary?q=test HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

路径：`/_/search/summary`

参数：

- `q`: 搜索关键词

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "threads": [{
            "thread_id": 2412020,
            "forum_id": 25,
            "subject": "虾滑线test",
            "author": "安定精神科主任",
            "author_id": 276845,
            "dateline": 1765119999
        }],
        "thread_count": 1192,
        "users": [{
            "uid": 237983,
            "username": "testtest1",
            "group_id": 26,
            "level_id": 3,
            "group_title": "河蟹 (Lv.3)",
            "group_subtitle": "成电校友",
            "group_icon": "data/attachment/common/d3/common_10_usergroup_icon.gif"
        }],
        "user_count": 115,
        "tid_match": null,
        "uid_match": null
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

该接口会返回10个符合要求的帖子和10个符合要求的用户名。

特别地，当`q`是有效`tid`或`uid`时，会有`tid_match`或`uid_match`，下方的json响应删去了一些字段以突出需要的内容：

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "tid_match": {
            "thread_id": 287813,
            "forum_id": 61,
            "subject": "清华大学出版的《TCP/IP协议及网络编程技术》一书，罗军舟等编著",
            "author": "swimmingfish",
            "author_id": 20933,
            "dateline": 1240319618
        },
        "uid_match": {
            "uid": 287813,
            "username": "Range6",
            "group_id": 26,
            "level_id": 10,
            "group_title": "海豚 (Lv.10)",
            "group_subtitle": "",
            "group_icon": "data/attachment/common/b6/common_22_usergroup_icon.gif"
        }
    }
}
```

## 搜索帖子

```text
GET /_/search/threads?q=test&page=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

路径：`/_/search/threads`

参数：

- `q`: 搜索关键词
- `page`: 页码
- `author`: 用户名
- `digest`: 为1表示只搜索精华帖

说明：`q`, `page`, `author`, `digest`都可省略。

- `page`省略时默认为`1`
- 所有参数都省略时结果为所有帖子
- 只给出`digest`时结果为所有精华帖
- 同理，有很多种组合方式

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "total": 1192,
        "page_size": 20,
        "page": 1,
        "rows": [{
            "thread_id": 2412020,
            "forum_id": 25,
            "type_id": 0,
            "author": "安定精神科主任",
            "author_id": 276845,
            "subject": "虾滑线test",
            "dateline": 1765119999,
            "last_post": 1765120902,
            "last_poster": "虾滑线",
            "views": 352,
            "replies": 6,
            "display_order": 0,
            "is_rated": 0,
            "special": 0,
            "attachment": 0,
            "is_moderated": 0,
            "has_stick_reply": 0,
            "is_closed": 0,
            "recommends": 0,
            "recommend_add": 0,
            "recommend_sub": 0,
            "heats": 2,
            "status": 32,
            "favorite_times": 0,
            "share_times": 0,
            "stamp": -1,
            "icon": -1,
            "cover": 0,
            "max_position": 7,
            "comments": 0
        }]
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

## 搜索用户

```text
GET /_/search/users?q=test&page=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

路径：`/_/search/users`

参数：

- `q`: 搜索关键词
- `page`: 页码

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "total": 115,
        "page_size": 20,
        "page": 1,
        "rows": [{
            "uid": 178132,
            "username": "testtesttst",
            "group_id": 8,
            "level_id": 1,
            "group_title": "等待验证会员",
            "group_subtitle": "",
            "group_icon": ""
        }]
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```
