# 用户

要使用此文档所示的接口，请先[登录](./登录.md)。

## 获取账号信息

<details>
    <summary>数据包</summary>

```text
GET /_/user/me/profile?user_summary=1&visitors=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

可变路径：`/_/user/{uid}/profile` (可用`me`指代自己的uid)

参数：

- `user_summary`: 是否获取用户信息摘要
- `visitors`: 是否获取访问者信息

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "user_summary": {
            "uid": 287813,
            "username": "Range6",
            "group_id": 26,
            "level_id": 10,
            "group_title": "海豚 (Lv.10)",
            "group_subtitle": "",
            "group_icon": "data/attachment/common/b6/common_22_usergroup_icon.gif",
            "credits": 9017,
            "ext_credits": {
                "威望": 7,
                "水滴": 9820
            },
            "medals": [
                141,
                144,
                153,
                54,
                112,
                133,
                137,
                151,
                154,
                156,
                157
            ],
            "friends": 2,
            "threads": 434,
            "replies": 15221,
            "digests": 0,
            "views": 1213
        },
        "recent_visitors": [
            {
                "uid": 289226,
                "username": "mangosteen111",
                "dateline": 1765413015
            },
            {
                "uid": 287452,
                "username": "NoahShen",
                "dateline": 1765389888
            }
        ],
        "email": "email@example.com",
        "register_time": 1723621452,
        "introduction": "",
        "custom_title": "",
        "signature": "",
        "signature_format": "html",
        "online_time": 7416,
        "last_visit": 1765414763,
        "last_activity": 1765413634,
        "last_post": 1765292599,
        "register_ip": "139.205.143.40",
        "last_ip": "117.173.139.22"
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

说明：当`user_summary`为`1`时，才有`user_summary`字段。当`visitors`为`1`时，才有`recent_visitors`字段。

`recent_visitors`中的`dateline`为最近访问秒时间戳。

获取其他人时，没有`email`等敏感信息。

## 获取发布过的主题帖

<details>
    <summary>数据包</summary>

```text
GET /_/user/me/threads?page=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

可变路径：`/_/user/{uid}/threads` (可用`me`指代自己的uid)

参数：

- `page`: 页码
- `user_summary`: 是否获取用户信息摘要
- `visitors`: 是否获取访问者信息

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "total": 433,
        "page_size": 20,
        "page": 1,
        "rows": [
            {
                "thread_id": 2413300,
                "forum_id": 25,
                "type_id": 315,
                "author": "Range6",
                "author_id": 287813,
                "subject": "thread title",
                "dateline": 1765387285,
                "last_post": 1765414876,
                "last_poster": "橘猫一只",
                "views": 130,
                "replies": 4,
                "display_order": 0,
                "is_rated": 0,
                "special": 1,
                "attachment": 1,
                "is_moderated": 0,
                "has_stick_reply": 0,
                "is_closed": 0,
                "recommends": 0,
                "recommend_add": 0,
                "recommend_sub": 0,
                "heats": 2,
                "status": 32,
                "favorite_times": 0,
                "share_times": 0,
                "stamp": -1,
                "icon": -1,
                "cover": 0,
                "max_position": 5,
                "comments": 0,
                "reply_credit_remaining_amount": 40,
                "summary": "thread content test.txt",
                "summary_attachments": [
                    {
                        "attachment_id": 2687361,
                        "dateline": 1765384751,
                        "filename": "test.txt",
                        "size": 18,
                        "path": "/data/attachment/forum/202512/11/01eeo6_md6hvghbbmudxn9tsubiicyb.attach",
                        "description": "",
                        "price": 0,
                        "is_image": 0,
                        "width": 0,
                        "thumb": false,
                        "picid": 0
                    }
                ],
                "forum_name": "水手之家"
            },
            {
                "thread_id": 2412873,
                "forum_id": 70,
                "type_id": 134,
                "author": "Range6",
                "author_id": 287813,
                "subject": "React满分漏洞（CVE-2025-55182）",
                "dateline": 1765286677,
                "last_post": 1765287144,
                "last_poster": "fangjue",
                "views": 101,
                "replies": 4,
                "display_order": 0,
                "is_rated": 1,
                "special": 0,
                "attachment": 0,
                "is_moderated": 0,
                "has_stick_reply": 0,
                "is_closed": 0,
                "recommends": 0,
                "recommend_add": 0,
                "recommend_sub": 0,
                "heats": 1,
                "status": 32,
                "favorite_times": 0,
                "share_times": 0,
                "stamp": -1,
                "icon": -1,
                "cover": 0,
                "max_position": 5,
                "comments": 2,
                "summary": "摘要：React后端无条件反序列化并执行前端提交的任意js代码，导致RCE漏洞并...",
                "forum_name": "程序员之家"
            },
            {
                "thread_id": 2412212,
                "forum_id": 25,
                "type_id": 315,
                "author": "Range6",
                "author_id": 287813,
                "subject": "似乎只有今年关外网特别频繁？",
                "dateline": 1765165760,
                "last_post": 1765169319,
                "last_poster": "河畔边的银杏树",
                "views": 721,
                "replies": 10,
                "display_order": 0,
                "is_rated": 0,
                "special": 0,
                "attachment": 0,
                "is_moderated": 0,
                "has_stick_reply": 0,
                "is_closed": 0,
                "recommends": 1,
                "recommend_add": 1,
                "recommend_sub": 0,
                "heats": 9,
                "status": 32,
                "favorite_times": 0,
                "share_times": 0,
                "stamp": -1,
                "icon": -1,
                "cover": 0,
                "max_position": 11,
                "comments": 0,
                "summary": "...",
                "summary_attachments": [
                    {
                        "attachment_id": 2686539,
                        "dateline": 1765166117,
                        "filename": "image.png",
                        "size": 323282,
                        "path": "/thumb/data/attachment/forum/202512/08/0pjuzm_tnjid45g6nvqu3liftqm3gm6.png?variant=original",
                        "description": "",
                        "price": 0,
                        "is_image": 1,
                        "width": 1898,
                        "thumb": false,
                        "picid": 0,
                        "thumbnail_url": "/thumb/data/attachment/forum/202512/08/0pjuzm_tnjid45g6nvqu3liftqm3gm6.png",
                        "raw_url": "/data/attachment/forum/202512/08/0pjuzm_tnjid45g6nvqu3liftqm3gm6.png"
                    }
                ],
                "forum_name": "水手之家"
            }
        ]
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

说明：散水帖还有水时，`reply_credit_remaining_amount`表示剩余水滴数，`special`经过测试，其实际含义为是否是投票帖。

## 获取发布过的回复

<details>
    <summary>数据包</summary>

```text
GET /_/user/me/replies?page=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

可变路径：`/_/user/{uid}/replies` (可用`me`指代自己的uid)

参数：

- `page`：页数
- `user_summary`: 是否获取用户信息摘要
- `visitors`: 是否获取访问者信息

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "total": 10730,
        "page_size": 20,
        "page": 1,
        "rows": [
            {
                "forum_id": 25,
                "thread_id": 2413300,
                "post_id": 41378081,
                "subject": "thread title",
                "summary": "test2",
                "dateline": 1765387563,
                "last_post": 1765415612,
                "last_poster": "交讓",
                "views": 159,
                "replies": 5,
                "forum_name": "水手之家"
            },
            {
                "forum_id": 25,
                "thread_id": 2412877,
                "post_id": 41374686,
                "subject": "安卓版河畔lite是用不了了吗",
                "summary": "感觉是WebVPN会话掉了，但软件认为还在，所以不弹VPN登录界面。然后lite的错误全是静默处理，不向用户抛提示，导致你不知到发生了什么。\n\n银杏叶内网版也会有这种情况（WebVPN会话掉了，但软件认为还在），但要好一点，因为银杏叶会给你抛错误提示，起码你知道发生了什么，清后台多开几次就会自动弹出VPN登录界面。",
                "dateline": 1765289232,
                "last_post": 1765319201,
                "last_poster": "fangjue",
                "views": 182,
                "replies": 27,
                "forum_name": "水手之家"
            },
            {
                "forum_id": 25,
                "thread_id": 2412877,
                "post_id": 41374579,
                "subject": "安卓版河畔lite是用不了了吗",
                "summary": "因为河畔关外网了，外部请求抛403。但是lite没告诉你403了，而是直接忽略了（从表现来看是这样），所以看起来不能使用了。",
                "dateline": 1765287483,
                "last_post": 1765319201,
                "last_poster": "fangjue",
                "views": 182,
                "replies": 27,
                "forum_name": "水手之家"
            }
        ]
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

注意到，在同一个帖子进行多个回复，会按照时间顺序都显示出来。

说明：

- `subject`: 回复所在帖子标题
- `summary`: 你的回复内容
- `dateline`: 回复时间
- `last_post`: 这个主题帖最后被回复时间
- `last_poster`: 这个主题帖最后回复人
- `views`: 主题帖浏览次数
- `replies`: 主题帖回复数

## 获取发布过的点评

<details>
    <summary>数据包</summary>

```text
GET /_/user/me/postcomments?page=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

可变路径：`/_/user/{uid}/postcomments` (可用`me`指代自己的uid)

参数：

- `page`：页数
- `user_summary`: 是否获取用户信息摘要
- `visitors`: 是否获取访问者信息

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "total": 18,
        "page_size": 20,
        "page": 1,
        "rows": [
            {
                "forum_id": 70,
                "thread_id": 2412873,
                "post_id": 41374524,
                "subject": "React满分漏洞（CVE-2025-55182）",
                "summary": "comment message",
                "dateline": 1765377214,
                "last_post": 1765287144,
                "last_poster": "fangjue",
                "views": 101,
                "replies": 4,
                "forum_name": "程序员之家"
            }
        ]
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

说明：

- `subject`: 点评所在帖子标题
- `summary`: 你的点评内容
- `dateline`: 点评时间

## 获取好友列表

<details>
    <summary>数据包</summary>

```text
GET /_/user/me/friends?page=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

路径：`/_/user/me/friends`

参数：

- `page`：页数
- `user_summary`: 是否获取用户信息摘要
- `visitors`: 是否获取访问者信息

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "total": 2,
        "page_size": 20,
        "page": 1,
        "rows": [
            {
                "uid": 217527,
                "username": "Zhenger666",
                "group_id": 26,
                "level_id": 11,
                "group_title": "鲨鱼 (Lv.11)",
                "group_subtitle": "成电校友",
                "group_icon": "data/attachment/common/37/common_23_usergroup_icon.gif",
                "credits": 10724,
                "ext_credits": {
                    "威望": 13,
                    "水滴": 30653
                },
                "friends": 31,
                "replies": 41075,
                "threads": 183,
                "digests": 0,
                "latest_thread": {
                    "tid": 2410497,
                    "subject": "数字 IC 验证交流群",
                    "dateline": 1764903639
                }
            },
            {
                "uid": 266386,
                "username": "飞雪残鸣",
                "group_id": 3,
                "level_id": 9,
                "group_title": "版主",
                "group_subtitle": "",
                "group_icon": "data/attachment/common/ec/common_3_usergroup_icon.gif",
                "credits": 5536,
                "ext_credits": {
                    "威望": 8,
                    "水滴": 114
                },
                "friends": 23,
                "replies": 32514,
                "threads": 1426,
                "digests": 0,
                "latest_thread": {
                    "tid": 2413024,
                    "subject": "豆包手机的运行流程",
                    "dateline": 1765341339
                }
            }
        ],
        "hidden": false
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

说明：

- `credits`: 积分，与账号等级相关
- `friends`: 你好友的好友数
- `hidden`: 是否隐藏，隐藏后仅自己可见。当获取其他人时，可用于区分没有好友和隐藏好友。

## 获取本账号收藏的帖子

注意：与其余接口不同，你只能获取自己的收藏帖子。

<details>
    <summary>数据包</summary>

```text
GET /_/user/me/favorites?page=1&collections=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

路径：`/_/user/me/favorites`

参数：

- `page`：页数
- `collections`：是否包括淘专辑
- `user_summary`: 是否获取用户信息摘要
- `visitors`: 是否获取访问者信息

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "total": 47,
        "page_size": 20,
        "page": 1,
        "rows": [
            {
                "favorite_id": 644545,
                "target_id": 2234791,
                "target_type": "tid",
                "title": "清水河畔官方大红16号楼【请遵守版规】",
                "dateline": 1765392094,
                "thread_details": {
                    "thread_id": 2234791,
                    "forum_id": 25,
                    "type_id": 322,
                    "author": "Ah!",
                    "author_id": 237640,
                    "subject": "清水河畔官方大红16号楼【请遵守版规】",
                    "dateline": 1735660791,
                    "last_post": 1765416417,
                    "last_poster": "没有名字好用",
                    "views": 375592,
                    "replies": 660613,
                    "display_order": 0,
                    "is_rated": 0,
                    "special": 0,
                    "attachment": 1,
                    "is_moderated": 1,
                    "has_stick_reply": 0,
                    "is_closed": 0,
                    "recommends": 99,
                    "recommend_add": 104,
                    "recommend_sub": 5,
                    "heats": 4178,
                    "status": 261,
                    "favorite_times": 120,
                    "share_times": 0,
                    "stamp": -1,
                    "icon": -1,
                    "cover": 0,
                    "max_position": 660615,
                    "comments": 65,
                    "highlight_color": "#EE1B2E",
                    "highlight_bold": true,
                    "summary": "清水河畔官方大红16号楼（大红2025-01号楼）正式开启！迎新年啦！",
                    "forum_name": "水手之家"
                }
            },
            {
                "favorite_id": 631553,
                "target_id": 2308076,
                "target_type": "tid",
                "space_uid": 239815,
                "title": "记录一次勇敢的说不",
                "description": "用手机客户端收藏",
                "dateline": 1762161845,
                "thread_details": {
                    "thread_id": 2308076,
                    "forum_id": 45,
                    "type_id": 392,
                    "author": "CK在河畔",
                    "author_id": 239815,
                    "subject": "记录一次勇敢的说不",
                    "dateline": 1748228006,
                    "last_post": 1762161688,
                    "last_poster": "往春复如来",
                    "views": 15715,
                    "replies": 182,
                    "display_order": 0,
                    "is_rated": 1,
                    "special": 0,
                    "attachment": 0,
                    "is_moderated": 0,
                    "has_stick_reply": 0,
                    "is_closed": 0,
                    "recommends": 744,
                    "recommend_add": 752,
                    "recommend_sub": 9,
                    "heats": 766,
                    "status": 33024,
                    "favorite_times": 22,
                    "share_times": 0,
                    "stamp": -1,
                    "icon": -1,
                    "cover": 0,
                    "max_position": 184,
                    "comments": 5,
                    "summary": "要我说我最讨厌什么，就是那些每天过得纸醉金迷还腆着个脸来申请困难补助的人。 我...",
                    "summary_attachments": [
                        {
                            "attachment_id": 2576002,
                            "dateline": 1748228005,
                            "filename": "105325vaz4yzqpzvwb6zqs.png",
                            "size": 204395,
                            "path": "/thumb/data/attachment/forum/202505/26/105325vaz4yzqpzvwb6zqs.png?variant=original",
                            "description": "",
                            "price": 0,
                            "is_image": 1,
                            "width": 1260,
                            "thumb": false,
                            "picid": 0,
                            "thumbnail_url": "/thumb/data/attachment/forum/202505/26/105325vaz4yzqpzvwb6zqs.png",
                            "raw_url": "/data/attachment/forum/202505/26/105325vaz4yzqpzvwb6zqs.png"
                        },
                        {
                            "attachment_id": 2576003,
                            "dateline": 1748228005,
                            "filename": "105325jrrqp44lh92f4017.png",
                            "size": 179571,
                            "path": "/thumb/data/attachment/forum/202505/26/105325jrrqp44lh92f4017.png?variant=original",
                            "description": "",
                            "price": 0,
                            "is_image": 1,
                            "width": 1260,
                            "thumb": false,
                            "picid": 0,
                            "thumbnail_url": "/thumb/data/attachment/forum/202505/26/105325jrrqp44lh92f4017.png",
                            "raw_url": "/data/attachment/forum/202505/26/105325jrrqp44lh92f4017.png"
                        }
                    ],
                    "forum_name": "情感专区"
                }
            }
        ],
        "collections": [
            {
                "collection_id": 1130,
                "uid": 287813,
                "username": "Range6",
                "name": "test",
                "dateline": 1765390293,
                "follows": 0,
                "threads": 0,
                "comments": 0,
                "description": "测试用",
                "last_update": 1765391837,
                "average_rate": 0,
                "rates": 0,
                "latest_thread": {
                    "thread_id": 2234791,
                    "subject": "清水河畔官方大红16号楼【请遵守版规】",
                    "dateline": 1735660791,
                    "lastpost_author": "Ah!"
                },
                "last_visit": 1765390295,
                "keyword": "",
                "is_owner": true
            }
        ]
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

## 获取留言板

<details>
    <summary>数据包</summary>

```text
GET /_/user/1/comments?page=1 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

可变路径：`/_/user/{uid}/comments` (可用`me`指代自己的uid)

参数：

- `page`: 页码
- `user_summary`: 是否获取用户信息摘要
- `visitors`: 是否获取访问者信息

### 响应

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "total": 1,
        "page_size": 20,
        "page": 1,
        "rows": [
            {
                "comment_id": 7481,
                "author_id": 226748,
                "author": "看见偷影子的人",
                "dateline": 1638799905,
                "message": "\u0026nbsp;\u0026nbsp;\u003cimg src=\"static/image/smiley/comcom/18.gif\" class=\"vm\"\u003e"
            }
        ],
        "hidden": false
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

## 加指定用户好友

<details>
    <summary>数据包</summary>

```text
PUT /_/user/friend HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
Content-Length: 30

{"uid":296528,"message":"msg"}
```

</details>
<br>

方法：`PUT`

路径：`/_/user/friend`

负载：

```json
{
    "uid":296528,
    "message":"加好友的附言"
}
```

### 响应

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "friend_status": "requested"
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```
