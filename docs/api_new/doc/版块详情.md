# 版块详情

要使用此文档所示的接口，请先[登录](./登录.md)。

## 获取帖子列表指定页

以下是获取最新回复列表示例，每页固定20条。

<details>
    <summary>数据包</summary>

```text
GET /_/forum/toplist?idlist=newthread&page=2 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

地址：`/_/forum/toplist`

参数：

- `idlist`: 帖子列表类型，可选项参见[同时获得多个列表](#同时获得多个列表)。
- `page`: 页码

### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "newthread": [{
            "thread_id": 2413226,
            "forum_id": 25,
            "type_id": 1119,
            "author": "落落疏帘邀月",
            "author_id": 304252,
            "subject": "异地医保可以在校医院报销吗",
            "summary": "如题，父母在老家交过医保了（外省），在校医院报销可以用吗",
            "dateline": 1765371333,
            "last_post": 1765371333,
            "views": 0,
            "replies": 0,
            "label": ""
        }, {
            "thread_id": 2413205,
            "forum_id": 25,
            "type_id": 0,
            "author": "反转冲动",
            "author_id": 257091,
            "subject": "不知道做什么AI图了",
            "summary": "...",
            "summary_attachments": [{
                "attachment_id": 2687264,
                "dateline": 1765368943,
                "filename": "201543uartl3f09062vtbt.png",
                "size": 217340,
                "path": "/thumb/data/attachment/forum/202512/10/201543uartl3f09062vtbt.png?variant=original",
                "description": "",
                "price": 0,
                "is_image": 1,
                "width": 1408,
                "thumb": false,
                "picid": 0,
                "thumbnail_url": "/thumb/data/attachment/forum/202512/10/201543uartl3f09062vtbt.png",
                "raw_url": "/data/attachment/forum/202512/10/201543uartl3f09062vtbt.png"
            }],
            "dateline": 1765368944,
            "last_post": 1765370147,
            "views": 0,
            "replies": 3,
            "label": ""
        }]
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

### 同时获得多个列表

获取多个列表类型，请使用`idlist`参数传入多个列表类型，用`,`隔开。

可用类型：`newreply`, `newthread`, `digest`, `life`, `hotlist`

以下是获取所有类型列表的示例，每页固定20条。

<details>
    <summary>数据包</summary>

```text
GET /_/forum/toplist?idlist=newreply,newthread,digest,life,hotlist&page=2 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

地址：`/_/forum/toplist`

参数：

- `idlist`: 帖子列表类型
- `page`: 页码

#### 响应

由于响应的json长度较大，此处只展示一部分用于说明数据结构。

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "digest": [],
        "hotlist": [],
        "life": [],
        "newreply": [],
        "newthread": []
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```

`digest`等列表的具体格式，请参考上方的[获取帖子列表指定页](#获取帖子列表指定页)。

## 获取版块的分类及父版块

<details>
    <summary>数据包</summary>

```text
GET /_/forum/details?forum_id=25 HTTP/1.1
Host: bbs.uestc.edu.cn
Cookie: 有效Cookie
Authorization: 有效Authorization
```

</details>
<br>

方法：`GET`

地址：`/_/forum/details`

参数：

- `forum_id`: 版块tid

### 响应

```json
{
    "code": 0,
    "message": "success",
    "data": {
        "fid": 25,
        "name": "水手之家",
        "can_post_thread": true,
        "can_post_reply": true,
        "can_post_anonymously": false,
        "threads": 953260,
        "posts": 3820633,
        "todayposts": 1917,
        "yesterdayposts": 3770,
        "latest_thread": null,
        "moderators": ["Ah!", "飞雪残鸣", "通电螺线管"],
        "children": [{
            "fid": 371,
            "name": "密语",
            "hidden_home": false,
            "threads": 20120,
            "posts": 270090,
            "todayposts": 178,
            "yesterdayposts": 266,
            "latest_thread": {
                "thread_id": 2413262,
                "subject": "还有十天从零开始冲刺，xdm我能做到吗",
                "lastpost_time": 1765379380,
                "lastpost_author": "匿名",
                "lastpost_authorid": 0
            },
            "moderators": null,
            "children": null
        }],
        "parents": [{
            "fid": 273,
            "name": "成电校园",
            "hidden_home": false,
            "threads": 0,
            "posts": 0,
            "todayposts": 0,
            "yesterdayposts": 0,
            "latest_thread": null,
            "moderators": null,
            "children": null
        }],
        "thread_types": [{
            "type_id": 315,
            "name": "灌水"
        }, {
            "type_id": 318,
            "name": "寻人"
        }, {
            "type_id": 319,
            "name": "求助"
        }, {
            "type_id": 320,
            "name": "原创"
        }, {
            "type_id": 321,
            "name": "转帖"
        }, {
            "type_id": 322,
            "name": "版务",
            "moderators_only": true
        }, {
            "type_id": 323,
            "name": "其他"
        }],
        "optional_thread_type": true,
        "announcement": "\u003cdiv align=\"center\"\u003e\u003cimg id=\"aimg_ygUC0\"  class=\"zoom\" src=\"https://bbs.uestc.edu.cn/data/attachment/forum/201408/29/174735riuzpmfjquuz22j2.png\"   border=\"0\" alt=\"\" /\u003e\u003c/div\u003e\u003cbr /\u003e\r\n\u003cbr /\u003e\r\n\u003cdiv align=\"center\"\u003e\u003cstrong\u003e\u003ca href=\"https://bbs.uestc.edu.cn/forum.php?mod=viewthread\u0026amp;tid=1821753\" target=\"_blank\"\u003e\u003cfont size=\"3\"\u003e\u003cfont color=\"red\"\u003e清水河畔新手导航务必点击进入\u003c/font\u003e\u003c/font\u003e\u003c/a\u003e\u0026nbsp; \u0026nbsp;\u0026nbsp; \u0026nbsp;\u003cfont color=\"royalblue\"\u003e\u003cfont size=\"3\"\u003e\u003ca href=\"https://bbs.uestc.edu.cn/forum.php?mod=viewthread\u0026amp;tid=1806614\" target=\"_blank\"\u003e水手之家最新版规务必点击进入\u003c/a\u003e\u003c/font\u003e\u0026nbsp; \u0026nbsp;\u0026nbsp; \u0026nbsp;\u003c/font\u003e\u003c/strong\u003e\u003c/div\u003e",
        "announcement_format": "html",
        "post_notice": {
            "newthread": "[color=red][size=3][b]【温馨提示】请勿重复发帖、一帖发多区。\r\n禁止租、借、售一卡通、图书馆考研座位等学校禁止的和其他违反国家法律的物品，一经发现删帖处理，严重者禁言7天以上直至删除ID，必要时向学校相关部门举报。[/b][/size][/color]",
            "newthread_mobile": "",
            "newthread_quick": "",
            "reply": " ",
            "reply_mobile": "",
            "reply_quick": " ",
            "reply_quick_mobile": "",
            "editthread": "",
            "editthread_mobile": "",
            "poll": "[b][color=red]记票天数请设置为 3 天以内。[/color][/b]"
        },
        "post_notice_format": "bbcode",
        "reply_credit": {
            "allowed_credits": ["水滴"],
            "details": {
                "水滴": {
                    "remaining_credits": 9846,
                    "max_single_credits": 500,
                    "max_total_credits": 3000,
                    "tax_rate": 0.35
                }
            }
        },
        "live_thread_id": 2234791
    },
    "user": {
        "uid": 287813,
        "username": "Range6",
        "new_pm_legacy": false,
        "new_notification": 0,
        "new_pm": 0,
        "new_grouppm_legacy": false,
        "settings_version": 0
    },
    "system": {
        "settings_version": 11,
        "client_version": 1
    }
}
```
